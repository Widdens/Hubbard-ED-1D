function test_suite = test_unequal_time_gf_long_tau_6_sites
initTestSuite;
global in_NUM_EIGEN_VALUES_UP;
global in_NUM_EIGEN_VALUES_DN;
in_NUM_EIGEN_VALUES_UP = 15; % These are the smallest values that we can get away with such that the result still agrees with the brute-force results to within 0.1%
in_NUM_EIGEN_VALUES_DN = 9;
end

function inp = setup
inp.in_t = 1;
inp.in_U = 4;
inp.in_noOfSites = 6;
inp.in_noOfUp = 3;
inp.in_noOfDn = 5;
end

function teardown(inp)
% do nothing
end

function test_unqual_time_gf_1_0_up(inp)
in_tau = 1.0;
global in_NUM_EIGEN_VALUES_UP;
[ out_spinUpGreenFunction, dummy1 ] = unequalTimeGF_long_tau( inp.in_t, inp.in_U, in_tau, inp.in_noOfSites, inp.in_noOfUp, inp.in_noOfDn, in_NUM_EIGEN_VALUES_UP );

assertElementsAlmostEqual(out_spinUpGreenFunction,...
   [0.0043129 -0.0024579 -0.0010315 0.0026811 -0.0010315 -0.0024579;...
    -0.0024579 0.0043129 -0.0024579 -0.0010315 0.0026811 -0.0010315;...
    -0.0010315 -0.0024579 0.0043129 -0.0024579 -0.0010315 0.0026811;...
    0.0026811 -0.0010315 -0.0024579 0.0043129 -0.0024579 -0.0010315;...
    -0.0010315 0.0026811 -0.0010315 -0.0024579 0.0043129 -0.0024579;...
    -0.0024579 -0.0010315 0.0026811 -0.0010315 -0.0024579 0.0043129],...
   'relative', 0.001);
end

function test_unqual_time_gf_2_0_up(inp)
in_tau = 2;
global in_NUM_EIGEN_VALUES_UP;
[ out_spinUpGreenFunction, dummy1 ] = unequalTimeGF_long_tau( inp.in_t, inp.in_U, in_tau, inp.in_noOfSites, inp.in_noOfUp, inp.in_noOfDn, in_NUM_EIGEN_VALUES_UP );

assertElementsAlmostEqual(out_spinUpGreenFunction,...
   [4.6613e-05 -2.54e-05 -1.6017e-05 3.6236e-05 -1.6017e-05 -2.54e-05;...
    -2.54e-05 4.6613e-05 -2.54e-05 -1.6017e-05 3.6236e-05 -1.6017e-05;...
    -1.6017e-05 -2.54e-05 4.6613e-05 -2.54e-05 -1.6017e-05 3.6237e-05;...
    3.6236e-05 -1.6017e-05 -2.54e-05 4.6613e-05 -2.54e-05 -1.6017e-05;...
    -1.6017e-05 3.6236e-05 -1.6017e-05 -2.54e-05 4.6613e-05 -2.54e-05;...
    -2.54e-05 -1.6017e-05 3.6236e-05 -1.6017e-05 -2.54e-05 4.6613e-05],...
   'relative', 0.001);
end

function test_unqual_time_gf_3_0_up(inp)
in_tau = 3.0;
global in_NUM_EIGEN_VALUES_UP;
[ out_spinUpGreenFunction, dummy1 ] = unequalTimeGF_long_tau( inp.in_t, inp.in_U, in_tau, inp.in_noOfSites, inp.in_noOfUp, inp.in_noOfDn, in_NUM_EIGEN_VALUES_UP );

assertElementsAlmostEqual(out_spinUpGreenFunction,...
   [5.3638e-07 -2.8605e-07 -2.0964e-07 4.5502e-07 -2.0964e-07 -2.8605e-07;...
    -2.8605e-07 5.3638e-07 -2.8605e-07 -2.0964e-07 4.5502e-07 -2.0964e-07;...
    -2.0964e-07 -2.8605e-07 5.3638e-07 -2.8605e-07 -2.0964e-07 4.5502e-07;...
    4.5502e-07 -2.0964e-07 -2.8605e-07 5.3638e-07 -2.8605e-07 -2.0964e-07;...
    -2.0964e-07 4.5502e-07 -2.0964e-07 -2.8605e-07 5.3638e-07 -2.8605e-07;...
    -2.8605e-07 -2.0964e-07 4.5502e-07 -2.0964e-07 -2.8605e-07 5.3638e-07],...
        'relative', 0.001);
end

function test_unqual_time_gf_1_0_dn(inp)
in_tau = 1.0;
global in_NUM_EIGEN_VALUES_DN;
[ dummy1, out_spinDnGreenFunction  ] = unequalTimeGF_long_tau( inp.in_t, inp.in_U, in_tau, inp.in_noOfSites, inp.in_noOfUp, inp.in_noOfDn, in_NUM_EIGEN_VALUES_DN );

assertElementsAlmostEqual(out_spinDnGreenFunction,...
   [0.001352 -0.0013343 0.0013278 -0.0013178 0.0013278 -0.0013343;...
    -0.0013343 0.001352 -0.0013343 0.0013278 -0.0013178 0.0013278;...
    0.0013278 -0.0013343 0.001352 -0.0013343 0.0013278 -0.0013178;...
    -0.0013178 0.0013278 -0.0013343 0.001352 -0.0013343 0.0013278;...
    0.0013278 -0.0013178 0.0013278 -0.0013343 0.001352 -0.0013343;...
    -0.0013343 0.0013278 -0.0013178 0.0013278 -0.0013343 0.001352],...
    'relative', 0.001);
end

function test_unqual_time_gf_2_0_dn(inp)
in_tau = 2;
global in_NUM_EIGEN_VALUES_DN;
[ dummy1, out_spinDnGreenFunction  ] = unequalTimeGF_long_tau( inp.in_t, inp.in_U, in_tau, inp.in_noOfSites, inp.in_noOfUp, inp.in_noOfDn, in_NUM_EIGEN_VALUES_DN );

assertElementsAlmostEqual(out_spinDnGreenFunction,...
   [1.216e-05 -1.2141e-05 1.2133e-05 -1.2118e-05 1.2133e-05 -1.2141e-05;...
    -1.2141e-05 1.216e-05 -1.2141e-05 1.2133e-05 -1.2118e-05 1.2133e-05;...
    1.2133e-05 -1.2141e-05 1.216e-05 -1.2141e-05 1.2133e-05 -1.2118e-05;...
    -1.2118e-05 1.2133e-05 -1.2141e-05 1.216e-05 -1.2141e-05 1.2133e-05;...
    1.2133e-05 -1.2118e-05 1.2133e-05 -1.2141e-05 1.216e-05 -1.2141e-05;...
    -1.2141e-05 1.2133e-05 -1.2118e-05 1.2133e-05 -1.2141e-05 1.216e-05],...
       'relative', 0.001);
end

function test_unqual_time_gf_3_0_dn(inp)
in_tau = 3.0;
global in_NUM_EIGEN_VALUES_DN;
[ dummy1, out_spinDnGreenFunction  ] = unequalTimeGF_long_tau( inp.in_t, inp.in_U, in_tau, inp.in_noOfSites, inp.in_noOfUp, inp.in_noOfDn, in_NUM_EIGEN_VALUES_DN );

assertElementsAlmostEqual(out_spinDnGreenFunction,...
   [1.106e-07 -1.1058e-07 1.1057e-07 -1.1055e-07 1.1057e-07 -1.1058e-07;...
    -1.1058e-07 1.106e-07 -1.1058e-07 1.1057e-07 -1.1055e-07 1.1057e-07;...
    1.1057e-07 -1.1058e-07 1.106e-07 -1.1058e-07 1.1057e-07 -1.1055e-07;...
    -1.1055e-07 1.1057e-07 -1.1058e-07 1.106e-07 -1.1058e-07 1.1057e-07;...
    1.1057e-07 -1.1055e-07 1.1057e-07 -1.1058e-07 1.106e-07 -1.1058e-07;...
    -1.1058e-07 1.1057e-07 -1.1055e-07 1.1057e-07 -1.1058e-07 1.106e-07],...
            'relative', 0.001);
end